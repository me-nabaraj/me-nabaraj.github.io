<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grammar Quiz</title>
 <script>
        // Array of CSS file names
        const stylesheets = ["reportedStyle1.css", "reportedStyle2.css"];

        // Select a random stylesheet
        const randomStylesheet = stylesheets[Math.floor(Math.random() * stylesheets.length)];

        // Create a link element
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.href = randomStylesheet;

        // Append to head
        document.head.appendChild(link);
    </script> 
</head>
<body>
  <div class="quiz-container">
    <h1>Grammar Quiz: Reported Speech</h1>
    <div id="question-container">
      <p id="sentence"></p>
      <input type="text" id="answer-input" placeholder="Write the reported form here...">
      <button id="show-answer-btn" onmousedown="showAnswer()">Show Answer</button>
      <p id="feedback">You are on the way......keep up.</p> <!-- Placeholder text added -->
    </div>
    <div class="score-container">
      <p>Score: <span id="score">0</span></p>
    </div>
    <button id="next-btn" onclick="loadNextQuestion()">Next Question</button>
    <button id="reset-btn" onclick="resetQuiz()">Reset Quiz</button>
  </div>
<footer class="footer">
        <p>Game developed by <strong>Nabaraj Dhungana</strong></p>
    </footer>
  <script>
     const sentences = [
  {
    direct: "She said, 'I am going to the market.'",
    reported: [
      "She said that she was going to the market.",
      "She said she was going to the market."
    ]
  },
  {
    direct: "He said, 'I will call you tomorrow.'",
    reported: [
      "He said that he would call me the next day.",
      "He said he would call me the next day.",
      "He said that he would call me the following day.",
       "He said he would call me the following day."  
    ]
  },
  {
    direct: "They said, 'We have finished our homework.'",
    reported: [
      "They said that they had finished their homework.",
      "They said they had finished their homework."
    ]
  },
  {
    direct: "She said, 'I was reading a book when the phone rang.'",
    reported: [
      "She said that she had been reading a book when the phone rang.",
      "She said she had been reading a book when the phone rang."
    ]
  },
  {
    direct: "He said, 'I can help you with the project.'",
    reported: [
      "He said that he could help me with the project.",
      "He said he could help me with the project."
    ]
  },
  {
    direct: "They said, 'We are planning a trip next month.'",
    reported: [
      "They said that they were planning a trip the following month.",
      "They said they were planning a trip the following month.",
      "They said that they were planning a trip the next month.",
      "They said they were planning a trip the next month."
    ]
  },
  {
    direct: "She said, 'I have never been to Paris.'",
    reported: [
      "She said that she had never been to Paris.",
      "She said she had never been to Paris."
    ]
  },
  {
    direct: "He said, 'I will be waiting for you at the station.'",
    reported: [
      "He said that he would be waiting for me at the station.",
      "He said he would be waiting for me at the station."
    ]
  },
  {
    direct: "They said, 'We were playing football when it started raining.'",
    reported: [
      "They said that they had been playing football when it started raining.",
      "They said they had been playing football when it started raining."
    ]
  },
  {
    direct: "She said, 'I can't attend the meeting tomorrow.'",
    reported: [
      "She said that she couldn't attend the meeting the next day.",
      "She said she couldn't attend the meeting the next day.",
      "She said that she couldn't attend the meeting the following day.",
      "She said she couldn't attend the meeting the following day."
    ]
  }
];

let score = 0;
let isAnswerCorrectForCurrentQuestion = false;
let shuffledQuestions = []; // Array to store shuffled questions
let usedQuestions = []; // Array to track used questions

const sentenceElement = document.getElementById('sentence');
const answerInput = document.getElementById('answer-input');
const feedbackElement = document.getElementById('feedback');
const scoreElement = document.getElementById('score');
const nextButton = document.getElementById('next-btn');
const showAnswerButton = document.getElementById('show-answer-btn');

// Function to shuffle an array using the Fisher-Yates algorithm
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Function to load a random question
function loadRandomQuestion() {
  if (shuffledQuestions.length === 0) {
    // If all questions have been used, reshuffle and reset
    shuffledQuestions = shuffleArray([...sentences]);
    usedQuestions = [];
  }

  // Get the next question from the shuffled list
  const question = shuffledQuestions.pop();
  usedQuestions.push(question);

  // Display the question
  sentenceElement.textContent = question.direct;
  answerInput.value = '';
  answerInput.style.color = 'red';
  feedbackElement.textContent = 'Use proper punctuation, no extra spaces between.';
  feedbackElement.style.color = '#999';
  isAnswerCorrectForCurrentQuestion = false;
}

function showAnswer() {
  const currentQuestion = usedQuestions[usedQuestions.length - 1]; // Get the current question
  answerInput.value = currentQuestion.reported[0]; // Show the first correct answer
  answerInput.style.color = 'green';
}

function hideAnswer() {
  answerInput.value = '';
  answerInput.style.color = 'red';
}

function checkAnswer() {
  const currentQuestion = usedQuestions[usedQuestions.length - 1]; // Get the current question
  const userAnswer = answerInput.value.trim();
  const correctAnswers = currentQuestion.reported;

  // Check if the user's answer matches any of the correct answers
  const isCorrect = correctAnswers.some(correctAnswer => userAnswer === correctAnswer);

  if (isCorrect) {
    answerInput.style.color = 'green';
    feedbackElement.textContent = 'Correct!';
    feedbackElement.style.color = '#28a745';

    // Increment score only if the answer was not already correct for this question
    if (!isAnswerCorrectForCurrentQuestion) {
      score++;
      scoreElement.textContent = score;
      isAnswerCorrectForCurrentQuestion = true; // Mark the question as answered correctly
    }
  } else {
    answerInput.style.color = 'red';
    feedbackElement.textContent = 'You are on the way......keep it up.';
    feedbackElement.style.color = '#dc3545';
  }
}

function loadNextQuestion() {
  if (shuffledQuestions.length > 0 || usedQuestions.length < sentences.length) {
    loadRandomQuestion();
  } else {
    alert('Quiz completed! Your final score is ' + score);
    resetQuiz();
  }
}

function resetQuiz() {
  score = 0;
  scoreElement.textContent = score;
  shuffledQuestions = shuffleArray([...sentences]); // Reshuffle questions
  usedQuestions = [];
  loadRandomQuestion();
}

// Show answer only while the mouse is pressed down
showAnswerButton.addEventListener('mousedown', showAnswer);
showAnswerButton.addEventListener('mouseup', hideAnswer);
showAnswerButton.addEventListener('mouseleave', hideAnswer);

answerInput.addEventListener('input', checkAnswer);

// Load the first question when the page loads
window.onload = () => {
  shuffledQuestions = shuffleArray([...sentences]); // Shuffle questions initially
  loadRandomQuestion();
};
  </script>
</body>
</html>
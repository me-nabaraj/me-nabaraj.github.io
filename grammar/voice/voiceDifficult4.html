<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grammar Quiz</title>
  <link rel="stylesheet" href="voiceStyle.css">
</head>
<body>
  <div class="quiz-container">
    <h1>Grammar Quiz: Passive Voice</h1>
    <div id="question-container">
      <p id="sentence"></p>
      <input type="text" id="answer-input" placeholder="Write the passive form here...">
      <button id="show-answer-btn" onmousedown="showAnswer()">Show Answer</button>
      <p id="feedback">Your feedback here</p> <!-- Placeholder text added -->
    </div>
    <div class="score-container">
      <p>Score: <span id="score">0</span></p>
    </div>
    <button id="next-btn" onclick="loadNextQuestion()">Next Question</button>
    <button id="reset-btn" onclick="resetQuiz()">Reset Quiz</button>
  </div>
<footer class="footer">
        <p>Game developed by <strong>Nabaraj Dhungana</strong></p>
    </footer>
  <script>
      const sentences = [
  {
    active: "The teacher assigned a challenging project to the students.",
    passive: [
      "A challenging project was assigned to the students by the teacher.",
      "A challenging project was assigned by the teacher to the students.",
      "The students were assigned a challenging project by the teacher.",
      "The students were assigned a challenging project.",
      "A challenging project was assigned to the students."
    ]
  },
  {
    active: "Did anyone feed the dog while we were away?",
    passive: [
      "Was the dog fed by anyone while we were away?",
      "Was the dog fed while we were away?",
      "By anyone, was the dog fed while we were away?"
    ]
  },
  {
    active: "Please submit your assignments before the deadline.",
    passive: [
      "Your assignments should be submitted before the deadline.",
      "Let your assignments be submitted before the deadline.",
      "It is requested that your assignments be submitted before the deadline.",
      "You are requested to submit your assignments before the deadline."
    ]
  },
  {
    active: "The chef prepared a delicious meal for the guests.",
    passive: [
      "A delicious meal was prepared for the guests by the chef.",
      "A delicious meal was prepared by the chef for the guests.",
      "The guests were prepared a delicious meal by the chef.",
      "A delicious meal was prepared for the guests."
    ]
  },
  {
    active: "Why did the manager cancel the meeting?",
    passive: [
      "Why was the meeting canceled by the manager?",
      "Why was the meeting canceled?",
      "By the manager, why was the meeting canceled?"
    ]
  },
  {
    active: "The company launched a new product last week.",
    passive: [
      "A new product was launched by the company last week.",
      "A new product was launched last week by the company.",
      "Last week, a new product was launched by the company.",
      "A new product was launched last week."
    ]
  },
  {
    active: "Can you help me with this problem?",
    passive: [
      "Can I be helped with this problem?",
      "Can I be helped with this problem by you?",
      "Can I be helped by you with this problem?",
      "By you, can I be helped with this problem?"
    ]
  },
  {
    active: "The storm damaged several houses in the neighborhood.",
    passive: [
      "Several houses in the neighborhood were damaged by the storm.",
      "Several houses were damaged by the storm in the neighborhood.",
      "In the neighborhood, several houses were damaged by the storm."
    ]
  },
  {
    active: "Please do not leave the door open.",
    passive: [
      "The door should not be left open.",
      "Let the door not be left open.",
      "It is requested that the door not be left open."
    ]
  },
  {
    active: "The students are organizing a charity event next month.",
    passive: [
      "A charity event is being organized by the students next month.",
      "A charity event is being organized next month by the students.",
      "Next month, a charity event is being organized by the students."
    ]
  }
];

let score = 0;
let isAnswerCorrectForCurrentQuestion = false;
let shuffledQuestions = []; // Array to store shuffled questions
let usedQuestions = []; // Array to track used questions

const sentenceElement = document.getElementById('sentence');
const answerInput = document.getElementById('answer-input');
const feedbackElement = document.getElementById('feedback');
const scoreElement = document.getElementById('score');
const nextButton = document.getElementById('next-btn');
const showAnswerButton = document.getElementById('show-answer-btn');

// Function to shuffle an array using the Fisher-Yates algorithm
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Function to load a random question
function loadRandomQuestion() {
  if (shuffledQuestions.length === 0) {
    // If all questions have been used, reshuffle and reset
    shuffledQuestions = shuffleArray([...sentences]);
    usedQuestions = [];
  }

  // Get the next question from the shuffled list
  const question = shuffledQuestions.pop();
  usedQuestions.push(question);

  // Display the question
  sentenceElement.textContent = question.active;
  answerInput.value = '';
  answerInput.style.color = 'red';
  feedbackElement.textContent = 'Your feedback here';
  feedbackElement.style.color = '#999';
  isAnswerCorrectForCurrentQuestion = false;
}

function showAnswer() {
  const currentQuestion = usedQuestions[usedQuestions.length - 1]; // Get the current question
  answerInput.value = currentQuestion.passive[0]; // Show the first correct answer
  answerInput.style.color = 'green';
}

function hideAnswer() {
  answerInput.value = '';
  answerInput.style.color = 'red';
}

function checkAnswer() {
  const currentQuestion = usedQuestions[usedQuestions.length - 1]; // Get the current question
  const userAnswer = answerInput.value.trim();
  const correctAnswers = currentQuestion.passive;

  // Check if the user's answer matches any of the correct answers
  const isCorrect = correctAnswers.some(correctAnswer => userAnswer === correctAnswer);

  if (isCorrect) {
    answerInput.style.color = 'green';
    feedbackElement.textContent = 'Correct!';
    feedbackElement.style.color = '#28a745';

    // Increment score only if the answer was not already correct for this question
    if (!isAnswerCorrectForCurrentQuestion) {
      score++;
      scoreElement.textContent = score;
      isAnswerCorrectForCurrentQuestion = true; // Mark the question as answered correctly
    }
  } else {
    answerInput.style.color = 'red';
    feedbackElement.textContent = 'Incorrect. Try again!';
    feedbackElement.style.color = '#dc3545';
  }
}

function loadNextQuestion() {
  if (shuffledQuestions.length > 0 || usedQuestions.length < sentences.length) {
    loadRandomQuestion();
  } else {
    alert('Quiz completed! Your final score is ' + score);
    resetQuiz();
  }
}

function resetQuiz() {
  score = 0;
  scoreElement.textContent = score;
  shuffledQuestions = shuffleArray([...sentences]); // Reshuffle questions
  usedQuestions = [];
  loadRandomQuestion();
}

// Show answer only while the mouse is pressed down
showAnswerButton.addEventListener('mousedown', showAnswer);
showAnswerButton.addEventListener('mouseup', hideAnswer);
showAnswerButton.addEventListener('mouseleave', hideAnswer);

answerInput.addEventListener('input', checkAnswer);

// Load the first question when the page loads
window.onload = () => {
  shuffledQuestions = shuffleArray([...sentences]); // Shuffle questions initially
  loadRandomQuestion();
};
  </script>
</body>
</html>